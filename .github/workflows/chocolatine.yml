name: chocolatine
env:
  MIRROR_URL: "git@github.com:dssurvolt/mirror_repo.git"
  EXECUTABLES: "a.out"
on:
    push:
      branch-ignore:
        - 'ga-ignore*'

jobs:
  check_coding_style:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v2

      - name: Set up Docker
        uses: docker/setup-docker@v2

      - name: Run coding style checker
        run: |
          docker run --rm -v $(pwd):/code ghcr.io/epitech/coding-style-checker:latest check.sh $(pwd) $(pwd)

      - name: Display coding style errors
        run: |
          if [ -f coding-style-reports.log ]; then
            cat coding-style-reports.log
          fi

      - name: Fail the job if there are errors
        run: |
          if [ -f coding-style-reports.log ]; then
            exit 1
          fi